<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>ChessVerse - Play Online</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #312e2b;
            color: #ffffff;
            overflow-x: hidden;
        }
        
        .header {
            background: #262522;
            border-bottom: 1px solid #3d3d3d;
            padding: 0;
            height: 56px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 32px;
            padding-left: 16px;
        }
        
        .logo {
            font-size: 24px;
            font-weight: 700;
            color: #8b4d8b;
            text-decoration: none;
        }
        
        .nav-links {
            display: flex;
            gap: 24px;
        }
        
        .nav-links a {
            color: #b9b9b9;
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            padding: 8px 12px;
            border-radius: 4px;
            transition: all 0.2s;
        }
        
        .nav-links a:hover {
            color: #ffffff;
            background: #3d3d3d;
        }
        
        .header-right {
            padding-right: 16px;
        }

        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px 16px;
            display: flex;
            gap: 24px;
        }
        
        .game-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .board-container {
            position: relative;
            margin-bottom: 24px;
        }

        .chessboard {
            width: 640px;
            height: 640px;
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            grid-template-rows: repeat(8, 1fr);
            background: #8b4d8b;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .square {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            user-select: none;
        }
        
        .square.light {
            background: #eeeed2;
        }
        
        .square.dark {
            background: #8b4d8b;
        }
        
        .square.highlight {
            background: #f7f769 !important;
        }
        
        .square.possible-move {
            background: rgba(255, 255, 0, 0.3) !important;
        }
        
        .square.selected {
            background: #f7f769 !important;
            box-shadow: inset 0 0 0 3px #f7f769;
        }

        .piece {
            width: 85%;
            height: 85%;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            cursor: grab;
            transition: transform 0.1s;
            z-index: 10;
        }
        
        .piece:hover {
            transform: scale(1.1);
        }
        
        .piece.dragging {
            cursor: grabbing;
            transform: scale(1.2);
            z-index: 1000;
            pointer-events: none;
        }
        
        /* Pezzi bianchi */
        .piece.white.king { 
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 45 45'%3e%3cg fill='%23fff' fill-rule='evenodd' stroke='%23000' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3cpath d='M22.5 11.63V6'/%3e%3cpath d='M20 8h5' stroke-linecap='butt'/%3e%3cpath d='M22.5 25s4.5-7.5 3-10.5c0 0-1-2.5-3-2.5s-3 2.5-3 2.5c-1.5 3 3 10.5 3 10.5' fill='%23fff' stroke-linecap='butt' stroke-linejoin='miter'/%3e%3cpath d='M11.5 37c5.5 3.5 15.5 3.5 21 0v-7s9-4.5 6-10.5c-4-6.5-13.5-3.5-16 4V27v-3.5c-3.5-7.5-13-10.5-16-4-3 6 5 10 5 10V37z' fill='%23fff'/%3e%3cpath d='M11.5 30c5.5-3 15.5-3 21 0m-21 3.5c5.5-3 15.5-3 21 0m-21 3.5c5.5-3 15.5-3 21 0' stroke='%23000'/%3e%3c/g%3e%3c/svg%3e");
        }
        .piece.white.queen { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 45 45'%3e%3cg fill='%23fff' fill-rule='evenodd' stroke='%23000' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3cpath d='M8 12a2 2 0 1 1-4 0 2 2 0 1 1 4 0zM24.5 7.5a2 2 0 1 1-4 0 2 2 0 1 1 4 0zM41 12a2 2 0 1 1-4 0 2 2 0 1 1 4 0zM16 8.5a2 2 0 1 1-4 0 2 2 0 1 1 4 0zM33 9a2 2 0 1 1-4 0 2 2 0 1 1 4 0z'/%3e%3cpath d='M9 26c8.5-1.5 21-1.5 27 0l2-12-7 11V11l-5.5 13.5-3-15-3 15-5.5-13.5V25L7 14l2 12z' stroke-linecap='butt'/%3e%3cpath d='M9 26c0 2 1.5 2 2.5 4 1 1.5 1 1 .5 3.5-1.5 1-1.5 2.5-1.5 2.5-1.5 1.5.5 2.5.5 2.5 6.5 1 16.5 1 23 0 0 0 1.5-1 0-2.5 0 0 .5-1.5-1-2.5-.5-2.5-.5-2 .5-3.5 1-2 2.5-2 2.5-4-8.5-1.5-18.5-1.5-27 0z' stroke-linecap='butt'/%3e%3cpath d='M11.5 30c3.5-1 18.5-1 22 0M12 33.5c6-1 15-1 21 0' fill='none'/%3e%3c/g%3e%3c/svg%3e"); }
        .piece.white.rook { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 45 45'%3e%3cg fill='%23fff' fill-rule='evenodd' stroke='%23000' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3cpath d='M9 39h27v-3H9v3zM12 36v-4h21v4H12zM11 14V9h4v2h5V9h5v2h5V9h4v5' stroke-linecap='butt'/%3e%3cpath d='M34 14l-3 3H14l-3-3'/%3e%3cpath d='M31 17v12.5H14V17' stroke-linecap='butt' stroke-linejoin='miter'/%3e%3cpath d='M31 29.5l1.5 2.5h-20l1.5-2.5'/%3e%3cpath d='M11 14h23' fill='none' stroke-linejoin='miter'/%3e%3c/g%3e%3c/svg%3e"); }
        .piece.white.bishop { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 45 45'%3e%3cg fill='none' fill-rule='evenodd' stroke='%23000' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3cg fill='%23fff' stroke-linecap='butt'%3e%3cpath d='M9 36c3.39-.97 10.11.43 13.5-2 3.39 2.43 10.11 1.03 13.5 2 0 0 1.65.54 3 2-.68.97-1.65.99-3 .5-3.39-.97-10.11.46-13.5-1-3.39 1.46-10.11.03-13.5 1-1.354.49-2.323.47-3-.5 1.354-1.94 3-2 3-2zM15 32c2.5 2.5 12.5 2.5 15 0 .5-1.5 0-2 0-2 0-2.5-2.5-4-2.5-4 5.5-1.5 6-11.5-5-15.5-11 4-10.5 14-5 15.5 0 0-2.5 1.5-2.5 4 0 0-.5.5 0 2zM25 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 1 1 5 0z'/%3e%3c/g%3e%3cpath d='M17.5 26h10M15 30h15m-7.5-14.5v5M20 18h5' stroke-linejoin='miter'/%3e%3c/g%3e%3c/svg%3e"); }
        .piece.white.knight { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 45 45'%3e%3cg fill='none' fill-rule='evenodd' stroke='%23000' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3cpath d='M22 10c10.5 1 16.5 8 16 29H15c0-9 10-6.5 8-21' fill='%23fff'/%3e%3cpath d='M24 18c.38 2.91-5.55 7.37-8 9-3 2-2.82 4.34-5 4-1.042-.94 1.41-3.04 0-3-1 0 .19 1.23-1 2-1 0-4.003 1-4-4 0-2 6-12 6-12s1.89-1.9 2-3.5c-.73-.994-.5-2-.5-3 1-1 3 2.5 3 2.5h2s.78-1.992 2.5-3c1 0 1 3 1 3' fill='%23fff'/%3e%3cpath d='M9.5 25.5a.5.5 0 1 1-1 0 .5.5 0 1 1 1 0zM14.933 15.75a.5 1.5 30 1 1-.866-.5.5 1.5 30 1 1 .866.5z' fill='%23000'/%3e%3c/g%3e%3c/svg%3e"); }
        .piece.white.pawn { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 45 45'%3e%3cpath d='M22.5 9c-2.21 0-4 1.79-4 4 0 .89.29 1.71.78 2.38C17.33 16.5 16 18.59 16 21c0 2.03.94 3.84 2.41 5.03-3 1.06-7.41 5.55-7.41 13.47h23c0-7.92-4.41-12.41-7.41-13.47 1.47-1.19 2.41-3 2.41-5.03 0-2.41-1.33-4.5-3.28-5.62.49-.67.78-1.49.78-2.38 0-2.21-1.79-4-4-4z' fill='%23fff' stroke='%23000' stroke-width='1.5' stroke-linecap='round'/%3e%3c/svg%3e"); }
        
        /* Pezzi neri */
        .piece.black.king { 
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 45 45'%3e%3cg fill='%23000' fill-rule='evenodd' stroke='%23000' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3cpath d='M22.5 11.63V6' stroke='%23000'/%3e%3cpath d='M22.5 25s4.5-7.5 3-10.5c0 0-1-2.5-3-2.5s-3 2.5-3 2.5c-1.5 3 3 10.5 3 10.5' fill='%23000' stroke-linecap='butt' stroke-linejoin='miter'/%3e%3cpath d='M11.5 37c5.5 3.5 15.5 3.5 21 0v-7s9-4.5 6-10.5c-4-6.5-13.5-3.5-16 4V27v-3.5c-3.5-7.5-13-10.5-16-4-3 6 5 10 5 10V37z' fill='%23000'/%3e%3cpath d='M20 8h5' stroke='%23000' stroke-linecap='butt'/%3e%3cpath d='M32 29.5s8.5-4 6.03-9.65C34.15 14 25 18 22.5 24.5l.01 2.1-.01-2.1C20 18 9.906 14 6.997 19.85c-2.497 5.65 4.853 9 6.853 9.65' stroke='%23fff'/%3e%3cpath d='M11.5 30c5.5-3 15.5-3 21 0m-21 3.5c5.5-3 15.5-3 21 0m-21 3.5c5.5-3 15.5-3 21 0' stroke='%23fff'/%3e%3c/g%3e%3c/svg%3e");
        }
        .piece.black.queen { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 45 45'%3e%3cg fill='%23000' fill-rule='evenodd' stroke='%23000' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3cpath d='M8 12a2 2 0 1 1-4 0 2 2 0 1 1 4 0zM24.5 7.5a2 2 0 1 1-4 0 2 2 0 1 1 4 0zM41 12a2 2 0 1 1-4 0 2 2 0 1 1 4 0zM16 8.5a2 2 0 1 1-4 0 2 2 0 1 1 4 0zM33 9a2 2 0 1 1-4 0 2 2 0 1 1 4 0z'/%3e%3cpath d='M9 26c8.5-1.5 21-1.5 27 0l2-12-7 11V11l-5.5 13.5-3-15-3 15-5.5-13.5V25L7 14l2 12z' stroke-linecap='butt'/%3e%3cpath d='M9 26c0 2 1.5 2 2.5 4 1 1.5 1 1 .5 3.5-1.5 1-1.5 2.5-1.5 2.5-1.5 1.5.5 2.5.5 2.5 6.5 1 16.5 1 23 0 0 0 1.5-1 0-2.5 0 0 .5-1.5-1-2.5-.5-2.5-.5-2 .5-3.5 1-2 2.5-2 2.5-4-8.5-1.5-18.5-1.5-27 0z' stroke-linecap='butt'/%3e%3cpath d='M11.5 30c3.5-1 18.5-1 22 0M12 33.5c6-1 15-1 21 0' fill='none' stroke='%23fff'/%3e%3c/g%3e%3c/svg%3e"); }
        .piece.black.rook { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 45 45'%3e%3cg fill='%23000' fill-rule='evenodd' stroke='%23000' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3cpath d='M9 39h27v-3H9v3zM12.5 32l1.5-2.5h17l1.5 2.5h-20zM12 36v-4h21v4H12z' stroke-linecap='butt'/%3e%3cpath d='M14 29.5v-13h17v13H14z' stroke-linecap='butt' stroke-linejoin='miter'/%3e%3cpath d='M14 16.5L11 14h23l-3 2.5H14zM11 14V9h4v2h5V9h5v2h5V9h4v5H11z' stroke-linecap='butt'/%3e%3cpath d='M12 35.5h21M13 31.5h19M14 29.5h17M14 16.5h17M11 14h23' fill='none' stroke='%23fff' stroke-width='1' stroke-linejoin='miter'/%3e%3c/g%3e%3c/svg%3e"); }
        .piece.black.bishop { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 45 45'%3e%3cg fill='none' fill-rule='evenodd' stroke='%23000' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3cg fill='%23000' stroke-linecap='butt'%3e%3cpath d='M9 36c3.39-.97 10.11.43 13.5-2 3.39 2.43 10.11 1.03 13.5 2 0 0 1.65.54 3 2-.68.97-1.65.99-3 .5-3.39-.97-10.11.46-13.5-1-3.39 1.46-10.11.03-13.5 1-1.354.49-2.323.47-3-.5 1.354-1.94 3-2 3-2zM15 32c2.5 2.5 12.5 2.5 15 0 .5-1.5 0-2 0-2 0-2.5-2.5-4-2.5-4 5.5-1.5 6-11.5-5-15.5-11 4-10.5 14-5 15.5 0 0-2.5 1.5-2.5 4 0 0-.5.5 0 2zM25 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 1 1 5 0z'/%3e%3c/g%3e%3cpath d='M17.5 26h10M15 30h15m-7.5-14.5v5M20 18h5' stroke='%23fff' stroke-linejoin='miter'/%3e%3c/g%3e%3c/svg%3e"); }
        .piece.black.knight { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 45 45'%3e%3cg fill='none' fill-rule='evenodd' stroke='%23000' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3cpath d='M22 10c10.5 1 16.5 8 16 29H15c0-9 10-6.5 8-21' fill='%23000'/%3e%3cpath d='M24 18c.38 2.91-5.55 7.37-8 9-3 2-2.82 4.34-5 4-1.042-.94 1.41-3.04 0-3-1 0 .19 1.23-1 2-1 0-4.003 1-4-4 0-2 6-12 6-12s1.89-1.9 2-3.5c-.73-.994-.5-2-.5-3 1-1 3 2.5 3 2.5h2s.78-1.992 2.5-3c1 0 1 3 1 3' fill='%23000'/%3e%3cpath d='M9.5 25.5a.5.5 0 1 1-1 0 .5.5 0 1 1 1 0zM14.933 15.75a.5 1.5 30 1 1-.866-.5.5 1.5 30 1 1 .866.5z' fill='%23fff' stroke='%23fff'/%3e%3cpath d='M24.55 10.4l-.45 1.45.5.15c3.15 1 5.65 2.49 7.9 6.75S35.75 29.06 35.25 39l-.05.5h2.25l.05-.5c.5-10.06-.88-16.85-3.25-21.34-2.37-4.49-5.79-6.64-9.19-7.16l-.51-.1z' fill='%23fff' stroke='none'/%3e%3c/g%3e%3c/svg%3e"); }
        .piece.black.pawn { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 45 45'%3e%3cpath d='M22.5 9c-2.21 0-4 1.79-4 4 0 .89.29 1.71.78 2.38C17.33 16.5 16 18.59 16 21c0 2.03.94 3.84 2.41 5.03-3 1.06-7.41 5.55-7.41 13.47h23c0-7.92-4.41-12.41-7.41-13.47 1.47-1.19 2.41-3 2.41-5.03 0-2.41-1.33-4.5-3.28-5.62.49-.67.78-1.49.78-2.38 0-2.21-1.79-4-4-4z' fill='%23000' stroke='%23000' stroke-width='1.5' stroke-linecap='round'/%3e%3c/svg%3e"); }

        .sidebar {
            width: 320px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .panel {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .panel h3 {
            color: #ffffff;
            margin-bottom: 12px;
            font-size: 16px;
            font-weight: 600;
        }

        .player-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #3d3d3d;
        }

        .player-info:last-child {
            border-bottom: none;
        }

        .player-name {
            font-weight: 600;
            color: #ffffff;
        }

        .player-time {
            color: #b5b5b5;
            font-family: monospace;
        }

        .current-turn {
            background: #f0d9b5;
            color: #2a2a2a;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 12px;
            font-weight: 600;
        }

        .moves-panel {
            background: #1e1e1e;
            border-radius: 8px;
            padding: 16px;
            flex: 1;
            overflow: hidden;
        }

        .moves-panel h3 {
            color: #f0d9b5;
            margin-bottom: 12px;
            font-size: 16px;
        }

        .moves-list {
            height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 14px;
            line-height: 1.4;
            color: #b5b5b5;
        }

        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
        }

        .btn-primary {
            background: #81b64c;
            color: white;
        }

        .btn-primary:hover {
            background: #7aa23d;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #4a4a4a;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a5a5a;
            transform: translateY(-1px);
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-1px);
        }

        .status-message {
            text-align: center;
            padding: 12px;
            border-radius: 6px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .status-info {
            background: rgba(13, 110, 253, 0.1);
            color: #6ea8fe;
            border: 1px solid rgba(13, 110, 253, 0.2);
        }

        .status-success {
            background: rgba(25, 135, 84, 0.1);
            color: #75b798;
            border: 1px solid rgba(25, 135, 84, 0.2);
        }

        .status-warning {
            background: rgba(255, 193, 7, 0.1);
            color: #ffda6a;
            border: 1px solid rgba(255, 193, 7, 0.2);
        }

        .status-error {
            background: rgba(220, 53, 69, 0.1);
            color: #ea868f;
            border: 1px solid rgba(220, 53, 69, 0.2);
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .main-container {
                flex-direction: column;
                padding: 15px;
            }
            
            .sidebar {
                width: 100%;
                order: -1;
            }
            
            .chessboard {
                width: 480px;
                height: 480px;
            }
            
            .piece {
                width: 50px;
                height: 50px;
                font-size: 45px;
            }
        }

        /* Bottoni */
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
        }

        .btn-primary {
            background: #8b4d8b;
            color: white;
        }

        .btn-primary:hover {
            background: #7a427a;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #4a4a4a;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a5a5a;
            transform: translateY(-1px);
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-1px);
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .main-container {
                flex-direction: column;
                padding: 15px;
            }
            
            .sidebar {
                width: 100%;
                order: -1;
            }
            
            .chessboard {
                width: 480px;
                height: 480px;
            }
        }

        .sidebar {
            width: 280px;
            background: #262421;
            border-radius: 8px;
            padding: 20px;
            height: fit-content;
        }
        
        .sidebar h3 {
            color: #ffffff;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
        }
        
        .online-notice {
            background: #262421;
            border: 2px solid #8b4d8b;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .online-notice h3 {
            color: #8b4d8b;
            margin: 0 0 12px 0;
            font-size: 18px;
        }
        
        .online-notice p {
            color: #b9b9b9;
            margin: 0;
            line-height: 1.5;
        }
        
        .controls {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .btn {
            padding: 12px 16px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background: #8b4d8b;
            color: #ffffff;
        }
        
        .btn-primary:hover {
            background: #7a427a;
        }
        
        .btn-secondary {
            background: #3d3d3d;
            color: #ffffff;
        }
        
        .btn-secondary:hover {
            background: #4a4a4a;
        }
        
        .game-status {
            text-align: center;
            padding: 12px;
            background: #1a1a1a;
            border-radius: 4px;
            color: #ffffff;
            font-weight: 500;
            margin-bottom: 20px;
        }
        
        .new-game-btn {
            background: #8b4d8b;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            margin-bottom: 12px;
        }
        
        .new-game-btn:hover {
            background: #7a427a;
        }

        @media (max-width: 768px) {
            .header-left {
                gap: 16px;
            }
            
            .nav-links {
                gap: 12px;
            }
            
            .nav-links a {
                padding: 6px 10px;
                font-size: 13px;
            }
            
            .chessboard {
                width: 360px;
                height: 360px;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-left">
            <a href="/" class="logo">ChessVerse</a>
            <nav class="nav-links">
                <a href="/">Homepage</a>
                <a href="/play" style="color: #ffffff; background: #3d3d3d;">Gioca Online</a>
                <a href="/bot">Bot Arena</a>
                <a href="#">Impara</a>
                <a href="#">Puzzle</a>
                <a href="#">Community</a>
            </nav>
        </div>
        <div class="header-right">
            <button class="btn btn-primary">Accedi</button>
        </div>
    </header>

    <div class="main-container">
        <div class="game-area">
            <div class="board-container">
                <div class="chessboard" id="chessboard"></div>
            </div>
            <div class="game-status" id="game-status">In attesa di avversario...</div>
        </div>

        <div class="sidebar">
            <div class="online-notice">
                <h3>ÔøΩ Modalit√† Online</h3>
                <p>Le partite multiplayer online saranno disponibili prossimamente. Per ora puoi allenarti contro i bot nella <a href="/bot" style="color: #8b4d8b;">Bot Arena</a> o giocare localmente nella <a href="/" style="color: #8b4d8b;">homepage</a>.</p>
            </div>
            
            <div class="controls">
                <button class="new-game-btn" onclick="resetGame()">üîÑ Nuova Partita</button>
                <button class="btn btn-primary" onclick="window.location.href='/bot'">ü§ñ Bot Arena</button>
                <button class="btn btn-secondary" onclick="window.location.href='/'">üè† Homepage</button>
                <button class="btn btn-secondary">üìä Analizza</button>
                <button class="btn btn-secondary">ÔøΩ Condividi</button>
            </div>
        </div>
    </div>
                    Seleziona un avversario per iniziare
                </div>
                <div id="currentTurn" style="font-weight: 600; color: #ffffff;">
                    <!-- Viene popolato dinamicamente -->
                </div>
            </div>

            <!-- Cronologia Mosse -->
            <div class="panel">
                <h3>üìù Cronologia Mosse</h3>
                <div id="movesList" style="font-family: monospace; font-size: 12px; color: #b9b9b9; max-height: 200px; overflow-y: auto;">
                    Le mosse appariranno qui...
                </div>
            </div>

            <!-- Controlli -->
            <div class="panel">
                <h3>üéÆ Controlli</h3>
                <div style="display: flex; flex-direction: column; gap: 8px;">
                    <button class="btn btn-secondary" onclick="newGame()" style="width: 100%;">üîÑ Nuova Partita</button>
                    <button class="btn btn-secondary" onclick="flipBoard()" style="width: 100%;">üîÑ Ruota Scacchiera</button>
                    <button class="btn btn-danger" onclick="resign()" style="width: 100%;">‚ùå Abbandona</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Stato iniziale della partita - modalit√† locale senza bot
        let gameState = {
            fen: "rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",
            turn: 'white',
            currentPlayer: 'white',
            selectedSquare: null,
            draggedPiece: null,
            possibleMoves: [],
            gameOver: false,
            winner: null,
            isPlayingBot: false,
            onlineMode: true
        };

        // Mappa FEN -> CSS classes
        const pieceMap = {
            'K': 'piece white king', 'Q': 'piece white queen', 'R': 'piece white rook',
            'B': 'piece white bishop', 'N': 'piece white knight', 'P': 'piece white pawn',
            'k': 'piece black king', 'q': 'piece black queen', 'r': 'piece black rook',
            'b': 'piece black bishop', 'n': 'piece black knight', 'p': 'piece black pawn'
        };

        function positionToSquare(row, col) {
            return String.fromCharCode(97 + col) + (8 - row);
        }

        function squareToPosition(square) {
            const col = square.charCodeAt(0) - 97;
            const row = 8 - parseInt(square[1]);
            return [row, col];
        }

        // Funzione per resettare la partita
        function resetGame() {
            gameState = {
                fen: 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1',
                turn: 'white',
                currentPlayer: 'white',
                selectedSquare: null,
                draggedPiece: null,
                possibleMoves: [],
                gameOver: false,
                winner: null,
                isPlayingBot: false,
                onlineMode: true
            };
            renderBoard();
            updateGameStatus();
        }

        // Simboli dei pezzi
        const pieceSymbols = {
            'K': '‚ôî', 'Q': '‚ôï', 'R': '‚ôñ', 'B': '‚ôó', 'N': '‚ôò', 'P': '‚ôô',
            'k': '‚ôö', 'q': '‚ôõ', 'r': '‚ôú', 'b': '‚ôù', 'n': '‚ôû', 'p': '‚ôü'
        };

        // Inizializzazione
        document.addEventListener('DOMContentLoaded', function() {
            createBoard();
            updateBoard();
        });

        function createBoard() {
            const chessboard = document.getElementById('chessboard');
            chessboard.innerHTML = '';

            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    const square = document.createElement('div');
                    square.classList.add('square');
                    
                    // Colore alternato
                    if ((row + col) % 2 === 0) {
                        square.classList.add('light');
                    } else {
                        square.classList.add('dark');
                    }

                    // Coordinate
                    const actualRow = gameState.isFlipped ? row : 7 - row;
                    const actualCol = gameState.isFlipped ? 7 - col : col;
                    const squareNotation = String.fromCharCode(97 + actualCol) + (actualRow + 1);
                    square.dataset.square = squareNotation;
                    square.dataset.row = actualRow;
                    square.dataset.col = actualCol;

                    // Aggiungi coordinate visibili
                    if (col === 7) { // Numeri di riga
                        const rankCoord = document.createElement('div');
                        rankCoord.classList.add('coordinates', 'coord-rank');
                        rankCoord.textContent = actualRow + 1;
                        square.appendChild(rankCoord);
                    }
                    if (row === 7) { // Lettere di colonna
                        const fileCoord = document.createElement('div');
                        fileCoord.classList.add('coordinates', 'coord-file');
                        fileCoord.textContent = String.fromCharCode(97 + actualCol);
                        square.appendChild(fileCoord);
                    }

                    square.addEventListener('click', () => squareClick(square));
                    chessboard.appendChild(square);
                }
            }
        }

        function updateBoard() {
            const squares = document.querySelectorAll('.square');
            
            squares.forEach(square => {
                const row = parseInt(square.dataset.row);
                const col = parseInt(square.dataset.col);
                const piece = gameState.board[row][col];
                
                // Rimuovi pezzo esistente
                const existingPiece = square.querySelector('.piece');
                if (existingPiece) {
                    square.removeChild(existingPiece);
                }
                
                // Aggiungi nuovo pezzo se presente
                if (piece !== '.') {
                    const pieceElement = document.createElement('div');
                    pieceElement.classList.add('piece');
                    pieceElement.textContent = pieceSymbols[piece];
                    
                    if (piece === piece.toUpperCase()) {
                        pieceElement.classList.add('white');
                    } else {
                        pieceElement.classList.add('black');
                    }
                    
                    square.appendChild(pieceElement);
                }
            });
        }

        function squareClick(square) {
            const squarePos = square.dataset.square;
            
            if (gameState.selectedSquare) {
                if (gameState.selectedSquare === squarePos) {
                    clearSelection();
                } else {
                    makeMove(gameState.selectedSquare, squarePos);
                }
            } else {
                const piece = square.querySelector('.piece');
                if (piece && isPieceOwned(piece, gameState.currentPlayer)) {
                    selectSquare(squarePos);
                }
            }
        }

        function isPieceOwned(pieceElement, player) {
            return pieceElement.classList.contains(player);
        }

        function selectSquare(square) {
            clearSelection();
            gameState.selectedSquare = square;
            
            const squareElement = document.querySelector(`[data-square="${square}"]`);
            if (squareElement) {
                squareElement.classList.add('selected');
                showPossibleMoves(square);
            }
        }

        function clearSelection() {
            document.querySelectorAll('.square').forEach(sq => {
                sq.classList.remove('selected', 'possible-move');
            });
            gameState.selectedSquare = null;
        }

        function showPossibleMoves(fromSquare) {
            // Placeholder - qui andr√† la logica per mostrare le mosse possibili
            // Per ora mostra solo alcuni quadrati come esempio
        }

        function makeMove(from, to) {
            // Placeholder per la logica di movimento
            const fromCoords = squareToCoords(from);
            const toCoords = squareToCoords(to);
            
            const piece = gameState.board[fromCoords.row][fromCoords.col];
            
            if (piece !== '.') {
                // Muovi il pezzo
                gameState.board[toCoords.row][toCoords.col] = piece;
                gameState.board[fromCoords.row][fromCoords.col] = '.';
                
                // Aggiungi alla cronologia
                const moveNotation = `${from}-${to}`;
                gameState.moveHistory.push(moveNotation);
                
                // Cambia turno
                gameState.currentPlayer = gameState.currentPlayer === 'white' ? 'black' : 'white';
                
                updateBoard();
                updateMovesList();
                updateTurnIndicator();
                clearSelection();
                
                // Se √® il turno del bot, fai la mossa del bot dopo un breve delay
                if (gameState.gameMode === 'bot' && gameState.currentPlayer !== gameState.playerColor) {
                    setTimeout(() => {
                        makeBotMove();
                    }, 500);
                }
            }
        }

        function squareToCoords(square) {
            const col = square.charCodeAt(0) - 97;
            const row = parseInt(square[1]) - 1;
            return { row, col };
        }

        function coordsToSquare(row, col) {
            return String.fromCharCode(97 + col) + (row + 1);
        }

        function updateMovesList() {
            const movesList = document.getElementById('movesList');
            if (gameState.moveHistory.length === 0) {
                movesList.innerHTML = '<div style="color: #666; font-style: italic;">Le mosse appariranno qui...</div>';
                return;
            }
            
            let movesHtml = '';
            for (let i = 0; i < gameState.moveHistory.length; i += 2) {
                const moveNum = Math.floor(i / 2) + 1;
                const whiteMove = gameState.moveHistory[i];
                const blackMove = gameState.moveHistory[i + 1] || '';
                
                movesHtml += `<div>${moveNum}. ${whiteMove} ${blackMove}</div>`;
            }
            
            movesList.innerHTML = movesHtml;
            movesList.scrollTop = movesList.scrollHeight;
        }

        function updateTurnIndicator() {
            const indicator = document.getElementById('turnIndicator');
            const statusMessage = document.getElementById('statusMessage');
            
            const currentPlayerName = gameState.currentPlayer === 'white' ? 'Bianco' : 'Nero';
            indicator.textContent = `Turno del ${currentPlayerName}`;
            statusMessage.textContent = `Partita in corso - √à il turno del ${currentPlayerName}`;
        }

        function newGame() {
            // Reset dello stato del gioco
            gameState.board = [
                ['r', 'n', 'b', 'q', 'k', 'b', 'n', 'r'],
                ['p', 'p', 'p', 'p', 'p', 'p', 'p', 'p'],
                ['.', '.', '.', '.', '.', '.', '.', '.'],
                ['.', '.', '.', '.', '.', '.', '.', '.'],
                ['.', '.', '.', '.', '.', '.', '.', '.'],
                ['.', '.', '.', '.', '.', '.', '.', '.'],
                ['P', 'P', 'P', 'P', 'P', 'P', 'P', 'P'],
                ['R', 'N', 'B', 'Q', 'K', 'B', 'N', 'R']
            ];
            gameState.currentPlayer = 'white';
            gameState.selectedSquare = null;
            gameState.moveHistory = [];
            gameState.gameStatus = 'playing';
            
            updateBoard();
            updateMovesList();
            updateTurnIndicator();
            clearSelection();
        }

        function flipBoard() {
            gameState.isFlipped = !gameState.isFlipped;
            createBoard();
            updateBoard();
        }

        function resign() {
            const currentPlayerName = gameState.currentPlayer === 'white' ? 'Bianco' : 'Nero';
            const winner = gameState.currentPlayer === 'white' ? 'Nero' : 'Bianco';
            
            if (confirm(`Sei sicuro di voler abbandonare? ${winner} vincer√† la partita.`)) {
                gameState.gameStatus = 'resigned';
                
                const statusMessage = document.getElementById('statusMessage');
                statusMessage.className = 'status-message status-success';
                statusMessage.textContent = `${winner} vince per abbandono!`;
            }
        }

        // Gestione selezione bot
        function toggleOpponentOptions() {
            const gameMode = document.getElementById('gameMode').value;
            const botOptions = document.getElementById('botOptions');
            
            if (gameMode === 'bot') {
                botOptions.style.display = 'block';
                updateBotLevel();
            } else {
                botOptions.style.display = 'none';
            }
        }

        function updateBotLevel() {
            const botType = document.getElementById('botType').value;
            const stockfishLevel = document.getElementById('stockfishLevel');
            
            if (botType === 'stockfish') {
                stockfishLevel.style.display = 'block';
                updateStockfishInfo();
            } else {
                stockfishLevel.style.display = 'none';
            }
        }

        function updateStockfishInfo() {
            const level = parseInt(document.getElementById('levelSelect').value);
            const info = document.getElementById('stockfishInfo');
            
            const levelInfos = {
                1: "Livello 1: Ideale per principianti, gioca con errori intenzionali.",
                2: "Livello 2: Principiante con miglioramenti graduali.",
                3: "Livello 3: Tattica di base, buono per imparare.",
                4: "Livello 4: Principiante avanzato, combinazioni semplici.",
                5: "Livello 5: Transizione verso intermedio.",
                6: "Livello 6: Intermedio - Tattica solida, pianificazione base.",
                7: "Livello 7: Intermedio - Combinazioni pi√π complesse.",
                8: "Livello 8: Intermedio forte - Strategia migliorata.",
                9: "Livello 9: Intermedio avanzato - Posizionale solido.",
                10: "Livello 10: Quasi esperto - Tattica raffinata.",
                11: "Livello 11: Avanzato - Calcolo profondo, strategia complessa.",
                12: "Livello 12: Avanzato - Gioco posizionale superiore.",
                13: "Livello 13: Quasi maestro - Preparazione teorica forte.",
                14: "Livello 14: Livello maestro - Calcolo preciso, strategia profonda.",
                15: "Livello 15: üî• SUPER MAESTRO - Gioco quasi perfetto!",
                16: "Livello 16: üíÄ KILLER ENGINE - Forza devastante, calcolo profondissimo!",
                17: "Livello 17: üëë BEAST MODE - Potenza massima, preparazione teorica assoluta!"
            };
            
            info.textContent = levelInfos[level] || "Informazioni non disponibili.";
        }

        function startGame() {
            const gameMode = document.getElementById('gameMode').value;
            
            if (gameMode === 'bot') {
                const botType = document.getElementById('botType').value;
                let botLevel = null;
                
                if (botType === 'stockfish') {
                    botLevel = parseInt(document.getElementById('levelSelect').value);
                }
                
                // Imposta lo stato del gioco
                gameState.gameMode = 'bot';
                gameState.botType = botType;
                gameState.botLevel = botLevel;
                gameState.playerColor = 'white'; // Il giocatore √® sempre bianco
                
                updateGameStatus();
                document.getElementById('opponentPanel').style.display = 'none';
                
            } else {
                gameState.gameMode = 'human';
                gameState.botType = null;
                gameState.botLevel = null;
                
                updateGameStatus();
                document.getElementById('opponentPanel').style.display = 'none';
            }
            
            // Reset del gioco
            newGame();
        }

        function updateGameStatus() {
            const gameStatus = document.getElementById('gameStatus');
            
            if (gameState.gameMode === 'bot') {
                if (gameState.botType === 'stockfish') {
                    gameStatus.textContent = `Partita contro Stockfish Livello ${gameState.botLevel}`;
                } else {
                    gameStatus.textContent = 'Partita contro Random Bot';
                }
            } else {
                gameStatus.textContent = 'Partita tra giocatori umani';
            }
        }

        // Funzione per fare la mossa del bot
        async function makeBotMove() {
            if (gameState.gameMode !== 'bot' || gameState.currentPlayer === gameState.playerColor) {
                return;
            }
            
            try {
                // Converti lo stato della scacchiera in FEN
                const fen = boardToFEN();
                
                const response = await fetch('/api/bot-move', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        fen: fen,
                        botType: gameState.botType,
                        level: gameState.botLevel
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.move) {
                        // Esegui la mossa del bot
                        const fromSquare = data.move.substring(0, 2);
                        const toSquare = data.move.substring(2, 4);
                        makeMove(fromSquare, toSquare);
                    }
                }
            } catch (error) {
                console.error('Errore nella mossa del bot:', error);
            }
        }

        // Funzione placeholder per convertire la board in FEN
        function boardToFEN() {
            // Implementazione semplificata - restituisce FEN iniziale per ora
            return 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1';
        }

        // URL Parameters per bot games (compatibilit√† con Bot Arena)
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('bot')) {
            const botType = urlParams.get('bot');
            const level = urlParams.get('level');
            
            // Inizializza automaticamente il bot
            if (botType === 'stockfish' && level) {
                document.getElementById('gameMode').value = 'bot';
                document.getElementById('botType').value = 'stockfish';
                document.getElementById('levelSelect').value = level;
                toggleOpponentOptions();
                startGame();
            }
        }
    </script>
</body>
</html>
